(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[304],{39156:function(e,t,l){"use strict";l.d(t,{Z:function(){return m}});var a=l(85893),n=l(41118),r=l(30208),s=l(40911),c=l(75227),i=l(67294);function o(e){let{chart:t}=e,l=(0,i.useRef)(null),o=(0,i.useRef)({chart:null});return(0,i.useEffect)(()=>{l.current&&(o.current.chart&&o.current.chart.destroy(),o.current.chart=new c.sg(l.current,{data:t.values,xField:"name",yField:"value",seriesField:"type",legend:{position:"bottom"},animation:{appear:{animation:"wave-in",duration:3e3}}}),o.current.chart.render())},[t.values]),(0,a.jsx)("div",{className:"flex-1 min-w-0",children:(0,a.jsx)(n.Z,{className:"h-full",sx:{background:"transparent"},children:(0,a.jsxs)(r.Z,{className:"h-full",children:[(0,a.jsx)(s.ZP,{gutterBottom:!0,component:"div",children:t.chart_name}),(0,a.jsx)(s.ZP,{gutterBottom:!0,level:"body3",children:t.chart_desc}),(0,a.jsx)("div",{className:"h-[300px]",ref:l})]})})})}function u(e){let{chart:t}=e,l=(0,i.useRef)(null),o=(0,i.useRef)({chart:null});return(0,i.useEffect)(()=>{l.current&&(o.current.chart&&o.current.chart.destroy(),o.current.chart=new c.x1(l.current,{data:t.values,xField:"name",yField:"value",seriesField:"type",smooth:!0,area:{style:{fillOpacity:.15}},legend:{position:"bottom"},animation:{appear:{animation:"wave-in",duration:3e3}}}),o.current.chart.render())},[t.values]),(0,a.jsx)("div",{className:"flex-1 min-w-0",children:(0,a.jsx)(n.Z,{className:"h-full",sx:{background:"transparent"},children:(0,a.jsxs)(r.Z,{className:"h-full",children:[(0,a.jsx)(s.ZP,{gutterBottom:!0,component:"div",children:t.chart_name}),(0,a.jsx)(s.ZP,{gutterBottom:!0,level:"body3",children:t.chart_desc}),(0,a.jsx)("div",{className:"h-[300px]",ref:l})]})})})}var d=l(61685),h=l(96486);function x(e){var t,l;let{chart:c}=e,i=(0,h.groupBy)(c.values,"type");return(0,a.jsx)("div",{className:"flex-1 min-w-0",children:(0,a.jsx)(n.Z,{className:"h-full overflow-auto",sx:{background:"transparent"},children:(0,a.jsxs)(r.Z,{className:"h-full",children:[(0,a.jsx)(s.ZP,{gutterBottom:!0,component:"div",children:c.chart_name}),(0,a.jsx)(s.ZP,{gutterBottom:!0,level:"body3",children:c.chart_desc}),(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsxs)(d.Z,{"aria-label":"basic table",stripe:"odd",hoverRow:!0,borderAxis:"bothBetween",children:[(0,a.jsx)("thead",{children:(0,a.jsx)("tr",{children:Object.keys(i).map(e=>(0,a.jsx)("th",{children:e},e))})}),(0,a.jsx)("tbody",{children:null===(t=Object.values(i))||void 0===t?void 0:null===(l=t[0])||void 0===l?void 0:l.map((e,t)=>{var l;return(0,a.jsx)("tr",{children:null===(l=Object.keys(i))||void 0===l?void 0:l.map(e=>{var l;return(0,a.jsx)("td",{children:(null==i?void 0:null===(l=i[e])||void 0===l?void 0:l[t].value)||""},e)})},t)})})]})})]})})})}var m=function(e){let{chartsData:t}=e,l=(0,i.useMemo)(()=>{if(t){let e=[],l=null==t?void 0:t.filter(e=>"IndicatorValue"===e.chart_type);l.length>0&&e.push({charts:l,type:"IndicatorValue"});let a=null==t?void 0:t.filter(e=>"IndicatorValue"!==e.chart_type),n=a.length,r=0;return[[0],[1],[2],[1,2],[1,3],[2,1,2],[2,1,3],[3,1,3],[3,2,3]][n].forEach(t=>{if(t>0){let l=a.slice(r,r+t);r+=t,e.push({charts:l})}}),e}},[t]);return(0,a.jsx)("div",{className:"flex flex-col gap-3",children:null==l?void 0:l.map((e,t)=>(0,a.jsx)("div",{className:"".concat((null==e?void 0:e.type)!=="IndicatorValue"?"flex gap-3":""),children:e.charts.map(e=>"IndicatorValue"===e.chart_type?(0,a.jsx)("div",{className:"flex flex-row gap-3",children:e.values.map(e=>(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)(n.Z,{sx:{background:"transparent"},children:(0,a.jsxs)(r.Z,{className:"justify-around",children:[(0,a.jsx)(s.ZP,{gutterBottom:!0,component:"div",children:e.name}),(0,a.jsx)(s.ZP,{children:e.value})]})})},e.name))},e.chart_uid):"LineChart"===e.chart_type?(0,a.jsx)(u,{chart:e},e.chart_uid):"BarChart"===e.chart_type?(0,a.jsx)(o,{chart:e},e.chart_uid):"Table"===e.chart_type?(0,a.jsx)(x,{chart:e},e.chart_uid):void 0)},"chart_row_".concat(t)))})}},70803:function(e,t,l){"use strict";l.d(t,{Z:function(){return B}});var a=l(85893),n=l(67294),r=l(2453),s=l(83062),c=l(31365),i=l(71577),o=l(49591),u=l(88484),d=l(29158),h=l(50489),x=l(41468),m=function(e){var t;let{convUid:l,chatMode:m,onComplete:p,...f}=e,[v,j]=(0,n.useState)(!1),[g,y]=r.ZP.useMessage(),[b,w]=(0,n.useState)([]),[Z,N]=(0,n.useState)(),{model:_}=(0,n.useContext)(x.p),P=async e=>{var t;if(!e){r.ZP.error("Please select the *.(csv|xlsx|xls) file");return}if(!/\.(csv|xlsx|xls)$/.test(null!==(t=e.file.name)&&void 0!==t?t:"")){r.ZP.error("File type must be csv, xlsx or xls");return}w([e.file])},C=async()=>{j(!0);try{let e=new FormData;e.append("doc_file",b[0]),g.open({content:"Uploading ".concat(b[0].name),type:"loading",duration:0});let[t]=await (0,h.Vx)((0,h.qn)({convUid:l,chatMode:m,data:e,model:_,config:{timeout:36e5,onUploadProgress:e=>{let t=Math.ceil(e.loaded/(e.total||0)*100);N(t)}}}));if(t)return;r.ZP.success("success"),null==p||p()}catch(e){r.ZP.error((null==e?void 0:e.message)||"Upload Error")}finally{j(!1),g.destroy()}};return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[y,(0,a.jsx)(s.Z,{placement:"bottom",title:"File cannot be changed after upload",children:(0,a.jsx)(c.default,{disabled:v,className:"mr-1",beforeUpload:()=>!1,fileList:b,name:"file",accept:".csv,.xlsx,.xls",multiple:!1,onChange:P,showUploadList:{showDownloadIcon:!1,showPreviewIcon:!1,showRemoveIcon:!1},itemRender:()=>(0,a.jsx)(a.Fragment,{}),...f,children:(0,a.jsx)(i.ZP,{className:"flex justify-center items-center",type:"primary",disabled:v,icon:(0,a.jsx)(o.Z,{}),children:"Select File"})})}),(0,a.jsx)(i.ZP,{type:"primary",loading:v,className:"flex justify-center items-center",disabled:!b.length,icon:(0,a.jsx)(u.Z,{}),onClick:C,children:v?100===Z?"Analysis":"Uploading":"Upload"}),!!b.length&&(0,a.jsxs)("div",{className:"mt-2 text-gray-500 text-sm flex items-center",children:[(0,a.jsx)(d.Z,{className:"mr-2"}),(0,a.jsx)("span",{children:null===(t=b[0])||void 0===t?void 0:t.name})]})]})})},p=function(e){let{onComplete:t}=e,{currentDialogue:l,scene:r,chatId:s}=(0,n.useContext)(x.p);return"chat_excel"!==r?null:(0,a.jsx)("div",{className:"max-w-md h-full relative",children:l?(0,a.jsxs)("div",{className:"flex h-8 overflow-hidden rounded",children:[(0,a.jsx)("div",{className:"flex items-center justify-center px-2 bg-gray-600 text-lg",children:(0,a.jsx)(d.Z,{className:"text-white"})}),(0,a.jsx)("div",{className:"flex items-center justify-center px-3 bg-gray-100 text-xs rounded-tr rounded-br dark:text-gray-800 truncate",children:l.select_param})]}):(0,a.jsx)(m,{convUid:s,chatMode:r,onComplete:t})})};l(23293);var f=l(78045),v=l(16165),j=l(96991),g=function(){return(0,a.jsx)("svg",{width:"1em",height:"1em",fill:"currentColor",viewBox:"0 0 1024 1024",version:"1.1",children:(0,a.jsx)("path",{d:"M602.24 246.72a17.28 17.28 0 0 0-11.84-16.32l-42.88-14.4A90.56 90.56 0 0 1 490.24 160l-14.4-42.88a17.28 17.28 0 0 0-32 0L428.8 160a90.56 90.56 0 0 1-57.28 57.28l-42.88 14.4a17.28 17.28 0 0 0 0 32l42.88 14.4a90.56 90.56 0 0 1 57.28 57.28l14.4 42.88a17.28 17.28 0 0 0 32 0l14.4-42.88a90.56 90.56 0 0 1 57.28-57.28l42.88-14.4a17.28 17.28 0 0 0 12.48-16.96z m301.12 221.76l-48.32-16a101.44 101.44 0 0 1-64-64l-16-48.32a19.2 19.2 0 0 0-36.8 0l-16 48.32a101.44 101.44 0 0 1-64 64l-48.32 16a19.2 19.2 0 0 0 0 36.8l48.32 16a101.44 101.44 0 0 1 64 64l16 48.32a19.2 19.2 0 0 0 36.8 0l16-48.32a101.44 101.44 0 0 1 64-64l48.32-16a19.2 19.2 0 0 0 0-36.8z m-376.64 195.52l-64-20.8a131.84 131.84 0 0 1-83.52-83.52l-20.8-64a25.28 25.28 0 0 0-47.68 0l-20.8 64a131.84 131.84 0 0 1-82.24 83.52l-64 20.8a25.28 25.28 0 0 0 0 47.68l64 20.8a131.84 131.84 0 0 1 83.52 83.84l20.8 64a25.28 25.28 0 0 0 47.68 0l20.8-64a131.84 131.84 0 0 1 83.52-83.52l64-20.8a25.28 25.28 0 0 0 0-47.68z","p-id":"3992"})})};function y(){let{isContract:e,setIsContract:t,scene:l}=(0,n.useContext)(x.p),r=l&&["chat_with_db_execute","chat_dashboard"].includes(l);return r?(0,a.jsxs)(f.ZP.Group,{value:e,defaultValue:!0,buttonStyle:"solid",onChange:()=>{t(!e)},children:[(0,a.jsxs)(f.ZP.Button,{value:!1,children:[(0,a.jsx)(v.Z,{component:g,className:"mr-1"}),"Preview"]}),(0,a.jsxs)(f.ZP.Button,{value:!0,children:[(0,a.jsx)(j.Z,{className:"mr-1"}),"Editor"]})]}):null}var b=l(81799),w=function(){return(0,a.jsx)("svg",{width:"1em",height:"1em",fill:"currentColor",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4870",children:(0,a.jsx)("path",{d:"M511.875 128.125c-211.875 0-383.75 76.25-383.75 170.625 0 94.375 171.875 170.625 383.75 170.625 211.875 0 383.75-76.25 383.75-170.625C896.25 204.375 724.375 128.125 511.875 128.125M128.125 383.75l0 128.125c0 94.375 171.875 170.625 383.75 170.625 211.875 0 383.75-76.25 383.75-170.625l0-128.125c0 94.375-171.875 170.625-383.75 170.625C300 555 128.125 478.125 128.125 383.75M128.125 597.5l0 128.125c0 94.375 171.875 170.625 383.75 170.625 211.875 0 383.75-76.25 383.75-170.625l0-128.125c0 94.375-171.875 170.625-383.75 170.625C300 768.125 128.125 691.875 128.125 597.5z","p-id":"4871"})})},Z=l(2093),N=l(51009),_=function(){let{scene:e,dbParam:t,setDbParam:l}=(0,n.useContext)(x.p),[r,s]=(0,n.useState)({});(0,Z.Z)(async()=>{let[,t]=await (0,h.Vx)((0,h.vD)(e));s(null!=t?t:{})},[e]);let c=(0,n.useMemo)(()=>Object.entries(r).map(e=>{let[t,l]=e;return{label:t,value:l}}),[r]);return((0,n.useEffect)(()=>{c.length&&!t&&l(c[0].value)},[c,l,t]),c.length)?(0,a.jsx)(N.default,{value:t,className:"w-36",onChange:e=>{l(e)},children:c.map(e=>(0,a.jsxs)(N.default.Option,{children:[(0,a.jsx)(v.Z,{component:w,className:"mr-1"}),e.label]},e.value))}):null},P=l(577),C=l(67421),k=function(){let{t:e}=(0,C.$G)(),{agentList:t,setAgentList:l}=(0,n.useContext)(x.p),{data:r=[]}=(0,P.Z)(async()=>{let[,e]=await (0,h.Vx)((0,h.N6)());return e&&e.length&&(null==l||l([e[0].name])),null!=e?e:[]});return r.length?(0,a.jsx)(N.default,{className:"w-60",value:t,mode:"multiple",maxTagCount:1,maxTagTextLength:12,placeholder:e("Select_Plugins"),options:r.map(e=>({label:e.name,value:e.name})),allowClear:!0,onChange:e=>{null==l||l(e)}}):null},B=function(e){let{refreshHistory:t,modelChange:l}=e,{scene:r,refreshDialogList:s}=(0,n.useContext)(x.p);return(0,a.jsxs)("div",{className:"w-full py-2 px-4 md:px-4 flex flex-wrap items-center justify-center border-b border-gray-100 gap-1 md:gap-4",children:[(0,a.jsx)(b.Z,{onChange:l}),(0,a.jsx)(_,{}),"chat_excel"===r&&(0,a.jsx)(p,{onComplete:()=>{null==s||s(),null==t||t()}}),"chat_agent"===r&&(0,a.jsx)(k,{}),(0,a.jsx)(y,{})]})}},81799:function(e,t,l){"use strict";l.d(t,{A:function(){return d}});var a=l(85893),n=l(41468),r=l(51009),s=l(19284),c=l(25675),i=l.n(c),o=l(67294),u=l(67421);function d(e,t){var l;let{width:n,height:r}=t||{};return e?(0,a.jsx)(i(),{className:"rounded-full border border-gray-200 object-contain bg-white inline-block",width:n||24,height:r||24,src:(null===(l=s.F[e])||void 0===l?void 0:l.icon)||"/models/huggingface.svg",alt:"llm"}):null}t.Z=function(e){let{onChange:t}=e,{t:l}=(0,u.$G)(),{modelList:c,model:i}=(0,o.useContext)(n.p);return!c||c.length<=0?null:(0,a.jsx)(r.default,{value:i,placeholder:l("choose_model"),className:"w-52",onChange:e=>{null==t||t(e)},children:c.map(e=>{var t;return(0,a.jsx)(r.default.Option,{children:(0,a.jsxs)("div",{className:"flex items-center",children:[d(e),(0,a.jsx)("span",{className:"ml-2",children:(null===(t=s.F[e])||void 0===t?void 0:t.label)||e})]})},e)})})}},99513:function(e,t,l){"use strict";l.d(t,{Z:function(){return u}});var a=l(85893),n=l(77119),r=l(63764),s=l(94184),c=l.n(s),i=l(67294),o=l(36782);function u(e){let{className:t,value:l,language:n="mysql",onChange:s,thoughts:u}=e,d=(0,i.useMemo)(()=>"mysql"!==n?l:u&&u.length>0?(0,o.WU)("-- ".concat(u," \n").concat(l)):(0,o.WU)(l),[l,u]);return(0,a.jsx)(r.ZP,{className:c()(t),value:d,language:n,onChange:s,theme:"vs-dark",options:{minimap:{enabled:!1},wordWrap:"on"}})}r._m.config({monaco:n})},30119:function(e,t,l){"use strict";l.d(t,{Tk:function(){return i},PR:function(){return o}});var a=l(2453),n=l(6154),r=l(83454);let s=n.Z.create({baseURL:r.env.API_BASE_URL});s.defaults.timeout=1e4,s.interceptors.response.use(e=>e.data,e=>Promise.reject(e)),l(96486);let c={"content-type":"application/json"},i=(e,t)=>{if(t){let l=Object.keys(t).filter(e=>void 0!==t[e]&&""!==t[e]).map(e=>"".concat(e,"=").concat(t[e])).join("&");l&&(e+="?".concat(l))}return s.get("/api"+e,{headers:c}).then(e=>e).catch(e=>{a.ZP.error(e),Promise.reject(e)})},o=(e,t)=>s.post(e,t,{headers:c}).then(e=>e).catch(e=>{a.ZP.error(e),Promise.reject(e)})},23293:function(){}}]);